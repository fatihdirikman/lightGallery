/**
 * lightgallery | 0.0.0 | December 24th 2020
 * http://sachinchoolur.github.io/lightGallery/
 * Copyright (c) 2020 Sachin Neravath;
 * @license GPLv3
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.lgZoom={})}(this,function(t){"use strict";var e,o={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300,useLeftForZoom:!!((e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./))&&parseInt(e[2],10)<54)},u=window.LG,a=(s.prototype.buildTemplates=function(){var t='<span class="lg-zoom-in lg-icon"></span><span class="lg-zoom-out lg-icon"></span>';this.s.actualSize&&(t+='<span class="lg-actual-size lg-icon"></span>'),this.s.useLeftForZoom?this.core.outer.addClass("lg-use-left-for-zoom"):this.core.outer.addClass("lg-use-transition-for-zoom"),this.core.outer.find(".lg-toolbar").first().append(t)},s.prototype.enableZoom=function(t){var e=this,o=this.s.enableZoomAfter+t.detail.delay;u("body").first().hasClass("lg-from-hash")&&t.detail.delay?o=0:u("body").first().removeClass("lg-from-hash"),this.zoomableTimeout=setTimeout(function(){e.core.getSlideItem(t.detail.index).addClass("lg-zoomable")},o+30)},s.prototype.enableZoomOnSlideItemLoad=function(){this.core.LGel.on("onSlideItemLoad.lg.tm.zoom",this.enableZoom.bind(this))},s.prototype.zoomImage=function(t){var e,o,a=this.core.outer.find(".lg-current .lg-image").first(),s=a.get();s&&(e=(this.core.outer.width()-s.offsetWidth)/2,o=(this.core.outer.height()-s.offsetHeight)/2+u(window).scrollTop(),1===t&&(this.positionChanged=!1),this.positionChanged&&(s=parseFloat(a.parent().attr("data-x"))/(parseFloat(a.attr("data-scale"))-1),a=parseFloat(a.parent().attr("data-y"))/(parseFloat(a.attr("data-scale"))-1),this.pageX=s+e,this.pageY=a+o,this.positionChanged=!1),e=(t-1)*(this.pageX-e),o=(t-1)*(this.pageY-o),this.setZoomStyles({x:e,y:o,scale:t}))},s.prototype.setZoomStyles=function(t){var e=this.core.outer.find(".lg-current .lg-image").first(),o=this.core.outer.find(".lg-current .lg-dummy-img").first(),a=e.parent();e.attr("data-scale",t.scale+"").css("transform","scale3d("+t.scale+", "+t.scale+", 1)"),o.css("transform","scale3d("+t.scale+", "+t.scale+", 1)"),this.s.useLeftForZoom?(a.css("left",-t.x+"px"),a.css("top",-t.y+"px")):(o="translate3d(-"+t.x+"px, -"+t.y+"px, 0)",a.css("transform",o)),a.attr("data-x",t.x).attr("data-y",t.y)},s.prototype.setActualSize=function(t,e){var o=this,a=this.core.getSlideItem(t).find(".lg-image").first().get().offsetWidth,t=this.getNaturalWidth(t)||a,a=this.getActualSizeScale(t,a);this.core.outer.hasClass("lg-zoomed")?this.scale=1:this.scale=this.getScale(a),this.setPageCords(e),this.beginZoom(this.scale),this.zoomImage(this.scale),setTimeout(function(){o.core.outer.removeClass("lg-grabbing").addClass("lg-grab")},10)},s.prototype.getNaturalWidth=function(t){var e=this.core.getSlideItem(t).find(".lg-image").first(),t=this.core.s.dynamic?this.core.s.dynamicEl[t].width:u(this.core.items).eq(t).attr("data-width");return t||e.get().naturalWidth},s.prototype.getActualSizeScale=function(t,e){e=e<t?t/e||2:1;return e},s.prototype.getPageCords=function(t){var e={};return t?(e.x=t.pageX||t.targetTouches[0].pageX,e.y=t.pageY||t.targetTouches[0].pageY):(e.x=this.core.outer.width()/2,e.y=this.core.outer.height()/2+u(window).scrollTop()),e},s.prototype.setPageCords=function(t){t=this.getPageCords(t);this.pageX=t.x,this.pageY=t.y},s.prototype.beginZoom=function(t){this.core.outer.removeClass("lg-zoom-drag-transition"),1<t?this.core.outer.addClass("lg-zoomed"):this.resetZoom()},s.prototype.getScale=function(t){var e=this.core.getSlideItem(this.core.index).find(".lg-image").first().get().offsetWidth,o=this.getNaturalWidth(this.core.index)||e,e=this.getActualSizeScale(o,e);return t<1?t=1:e<t&&(t=e),t},s.prototype.init=function(){var o=this;this.buildTemplates(),this.enableZoomOnSlideItemLoad();var a=null;this.core.outer.on("dblclick",function(t){u(t.target).hasClass("lg-image")&&o.setActualSize(o.core.index,t)}),this.core.outer.on("touchstart",function(t){var e=u(t.target);1===t.targetTouches.length&&e.hasClass("lg-image")&&(a?(clearTimeout(a),a=null,o.setActualSize(o.core.index,t)):a=setTimeout(function(){a=null},300),t.preventDefault())}),u(window).on("resize.lg.zoom orientationchange.lg.zoom",function(){o.core.lgOpened&&(o.setPageCords(),o.zoomImage(o.scale))}),this.core.outer.find(".lg-zoom-out").first().on("click.lg",function(){o.core.outer.find(".lg-current .lg-image").first()&&(o.scale-=o.s.scale,o.scale=o.getScale(o.scale),o.beginZoom(o.scale),o.zoomImage(o.scale))}),this.core.outer.find(".lg-zoom-in").first().on("click.lg",function(){o.core.outer.find(".lg-current .lg-image").first()&&(o.scale+=o.s.scale,o.scale=o.getScale(o.scale),o.beginZoom(o.scale),o.zoomImage(o.scale))}),this.core.outer.find(".lg-actual-size").first().on("click.lg",function(){o.setActualSize(o.core.index)}),this.core.LGel.on("onBeforeOpen.lg.tm",function(){o.core.outer.find(".lg-item").first().removeClass("lg-zoomable")}),this.core.LGel.on("onBeforeSlide.lg",function(){o.scale=1,o.resetZoom()}),this.zoomDrag(),this.pinchZoom(),this.zoomSwipe()},s.prototype.resetZoom=function(){this.core.outer.removeClass("lg-zoomed lg-zoom-drag-transition"),this.core.outer.find(".lg-img-wrap").first().removeAttr("style data-x data-y"),this.core.outer.find(".lg-image").first().removeAttr("style data-scale"),this.setPageCords()},s.prototype.getTouchDistance=function(t){return Math.sqrt((t.targetTouches[0].pageX-t.targetTouches[1].pageX)*(t.targetTouches[0].pageX-t.targetTouches[1].pageX)+(t.targetTouches[0].pageY-t.targetTouches[1].pageY)*(t.targetTouches[0].pageY-t.targetTouches[1].pageY))},s.prototype.pinchZoom=function(){var e=this,o=0,a=!1,s=1,t=u("#"+this.core.getById("lg-inner")),i=this.core.getSlideItem(this.core.index);t.on("touchstart.lg",function(t){i=e.core.getSlideItem(e.core.index),2===t.targetTouches.length&&(u(t.target).hasClass("lg-item")||i.get().contains(t.target))&&(s=e.scale||1,e.core.outer.removeClass("lg-zoom-drag-transition lg-zoom-dragging"),e.core.touchAction="pinch",o=e.getTouchDistance(t))}),t.on("touchmove.lg",function(t){2===t.targetTouches.length&&"pinch"===e.core.touchAction&&(u(t.target).hasClass("lg-item")||i.get().contains(t.target))&&(t=e.getTouchDistance(t),t=o-t,!a&&5<Math.abs(t)&&(a=!0),a&&(e.scale=Math.max(1,s+.008*-t),e.zoomImage(e.scale)))}),t.on("touchend.lg",function(t){"pinch"===e.core.touchAction&&(u(t.target).hasClass("lg-item")||i.get().contains(t.target))&&(a=!1,o=0,e.scale<=1?e.resetZoom():(e.scale=e.getScale(e.scale),e.zoomImage(e.scale),e.core.outer.addClass("lg-zoomed")),e.core.touchAction=void 0)})},s.prototype.touchendZoom=function(t,e,o,a,s){var i=e.x-t.x,r=e.y-t.y,n=Math.abs(i)/s+1,l=Math.abs(r)/s+1;2<n&&(n+=1),2<l&&(l+=1),i*=n,r*=l;e=this.core.getSlideItem(this.core.index).find(".lg-img-wrap").first(),t=this.core.getSlideItem(this.core.index).find(".lg-object").first(),s=parseFloat(e.attr("data-x"))||0,n=parseFloat(e.attr("data-y"))||0,l={};l.x=-Math.abs(s)+i,l.y=-Math.abs(n)+r;n=this.core.outer.find(".lg"),n=this.getPossibleSwipeCords(t,n);(15<Math.abs(i)||15<Math.abs(r))&&(a&&(l.y<=-n.maxY?l.y=-n.maxY:l.y>=-n.minY&&(l.y=-n.minY)),o&&(l.x<=-n.maxX?l.x=-n.maxX:l.x>=-n.minX&&(l.x=-n.minX)),a?e.attr("data-y",Math.abs(l.y)):(a=parseFloat(e.attr("data-y"))||0,l.y=-Math.abs(a)),o?e.attr("data-x",Math.abs(l.x)):(o=parseFloat(e.attr("data-x"))||0,l.x=-Math.abs(o)),this.setZoomSwipeStyles(e,l),this.positionChanged=!0)},s.prototype.getZoomSwipeCords=function(t,e,o,a,s,i,r){var n,l,c={};return a?(c.y=-Math.abs(i)+(e.y-t.y),c.y<=-s.maxY?(n=-s.maxY-c.y,c.y=-s.maxY-n/6):c.y>=-s.minY&&(n=c.y- -s.minY,c.y=-s.minY+n/6)):c.y=-Math.abs(i),o?(c.x=-Math.abs(r)+(e.x-t.x),c.x<=-s.maxX?(l=-s.maxX-c.x,c.x=-s.maxX-l/6):c.x>=-s.minX&&(l=c.x- -s.minX,c.x=-s.minX+l/6)):c.x=-Math.abs(r),c},s.prototype.getPossibleSwipeCords=function(t,e){var o={},a=e.height(),s=e.width(),i=t.get().offsetHeight,e=t.get().offsetWidth,t=parseFloat(t.attr("data-scale"))||1,t=Math.abs(t);return o.minY=(a-i)/2,o.maxY=Math.abs(i*t-a+o.minY),o.minX=(s-e)/2,o.maxX=Math.abs(e*t-s+o.minX),o},s.prototype.setZoomSwipeStyles=function(t,e){this.s.useLeftForZoom?(t.css("left",e.x+"px"),t.css("top",e.y+"px")):t.css("transform","translate3d("+e.x+"px, "+e.y+"px, 0)")},s.prototype.zoomSwipe=function(){var o,a,s=this,i={},e={},r=!1,n=!1,l=!1,c=new Date,g=(new Date,0),h=0,t=u("#"+this.core.getById("lg-inner")),d=this.core.getSlideItem(this.core.index);t.on("touchstart.lg",function(t){var e;d=s.core.getSlideItem(s.core.index),(u(t.target).hasClass("lg-item")||d.get().contains(t.target))&&1===t.targetTouches.length&&s.core.outer.hasClass("lg-zoomed")&&(c=new Date,s.core.touchAction="zoomSwipe",e=s.core.getSlideItem(s.core.index).find(".lg-object").first(),a=s.core.getSlideItem(s.core.index).find(".lg-img-wrap").first(),l=e.get().offsetHeight*parseFloat(e.attr("data-scale"))>s.core.outer.find(".lg").height(),((n=e.get().offsetWidth*parseFloat(e.attr("data-scale"))>s.core.outer.find(".lg").width())||l)&&(t.preventDefault(),i={x:t.targetTouches[0].pageX,y:t.targetTouches[0].pageY}),h=parseFloat(a.attr("data-y")),g=parseFloat(a.attr("data-x")),t=s.core.outer.find(".lg"),o=s.getPossibleSwipeCords(e,t),s.core.outer.addClass("lg-zoom-dragging lg-zoom-drag-transition"))}),t.on("touchmove.lg",function(t){1===t.targetTouches.length&&"zoomSwipe"===s.core.touchAction&&(u(t.target).hasClass("lg-item")||d.get().contains(t.target))&&(s.core.touchAction="zoomSwipe",t.preventDefault(),e={x:t.targetTouches[0].pageX,y:t.targetTouches[0].pageY},t=s.getZoomSwipeCords(i,e,n,l,o,h,g),(15<Math.abs(e.x-i.x)||15<Math.abs(e.y-i.y))&&(r=!0,s.setZoomSwipeStyles(a,t)))}),t.on("touchend.lg",function(t){"zoomSwipe"===s.core.touchAction&&(u(t.target).hasClass("lg-item")||d.get().contains(t.target))&&(s.core.touchAction=void 0,s.core.outer.removeClass("lg-zoom-dragging"),r&&(r=!1,t=(new Date).valueOf()-c.valueOf(),s.touchendZoom(i,e,n,l,t)))})},s.prototype.zoomDrag=function(){var o,e,a,s,i,r,n=this,l={},c={},g=!1,h=!1,d=!1,m=!1;this.core.outer.on("mousedown.lg.zoom",function(t){var e=n.core.getSlideItem(n.core.index);(u(t.target).hasClass("lg-item")||e.get().contains(t.target))&&(o=new Date,e=n.core.getSlideItem(n.core.index).find(".lg-object").first(),r=n.core.getSlideItem(n.core.index).find(".lg-img-wrap").first(),m=e.get().offsetHeight*parseFloat(e.attr("data-scale"))>n.core.outer.find(".lg").height(),d=e.get().offsetWidth*parseFloat(e.attr("data-scale"))>n.core.outer.find(".lg").width(),n.core.outer.hasClass("lg-zoomed")&&u(t.target).hasClass("lg-object")&&(d||m)&&(t.preventDefault(),l={x:t.pageX,y:t.pageY},t=n.core.outer.find(".lg"),a=n.getPossibleSwipeCords(e,t),g=!0,s=parseFloat(r.attr("data-y")),i=parseFloat(r.attr("data-x")),n.core.outer.get().scrollLeft+=1,--n.core.outer.get().scrollLeft,n.core.outer.removeClass("lg-grab").addClass("lg-grabbing lg-zoom-drag-transition lg-zoom-dragging")))}),u(window).on("mousemove.lg.zoom",function(t){g&&(h=!0,c={x:t.pageX,y:t.pageY},t=n.getZoomSwipeCords(l,c,d,m,a,s,i),n.setZoomSwipeStyles(r,t))}),u(window).on("mouseup.lg.zoom",function(t){g&&(e=new Date,g=!1,n.core.outer.removeClass("lg-zoom-dragging"),!h||l.x===c.x&&l.y===c.y||(c={x:t.pageX,y:t.pageY},t=e.valueOf()-o.valueOf(),n.touchendZoom(l,c,d,m,t)),h=!1),n.core.outer.removeClass("lg-grabbing").addClass("lg-grab")})},s.prototype.destroy=function(){this.core.LGel.off(".lg.zoom"),u(window).off(".lg.zoom"),this.core.outer.find(".lg-item").first().off(".lg.zoom"),this.core.LGel.off(".lg.tm.zoom"),this.resetZoom(),clearTimeout(this.zoomableTimeout),this.zoomableTimeout=!1},s);function s(t){return this.core=t,this.s=Object.assign({},o),this.s.zoom&&this.core.doCss()&&(this.init(),this.zoomableTimeout=!1,this.positionChanged=!1,this.pageX=this.core.outer.width()/2,this.pageY=this.core.outer.height()/2+u(window).scrollTop(),this.scale=1),this}window.lgModules.zoom=a,t.Zoom=a,Object.defineProperty(t,"__esModule",{value:!0})});
